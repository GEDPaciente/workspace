name: 'ðŸŽ›ï¸ Build Modulo'
description: 'Fluxo de atualizaÃ§Ã£o do Modulo'
inputs:
  github_token:
    description: 'Token de acesso ao GitHub'
    required: true
outputs:
  module_version:
    description: 'VersÃ£o do Modulo'
    value: ${{ steps.get_version.outputs.version }}

runs:
  using: 'composite'
  steps:
    - name: ðŸ”’ Verificar GitHub Token
      run: |
        if [ -z "${{ inputs.github_token }}" ]; then
          echo "GitHub Token nÃ£o fornecido."
          exit 1
        else
          echo "GitHub Token estÃ¡ presente."
        fi
      shell: bash

    - name: 'Checkout RepositÃ³rio Parent'
      uses: actions/checkout@v3
      with:
        ref: ${{ github.ref }}
        repository: GEDPaciente/mv-ged-parent
        token: ${{ inputs.github_token }}
        path: parent

    - name: 'Set up JDK 17'
      uses: actions/setup-java@v4
      with:
        distribution: 'corretto'
        java-version: '17'
    - name: 'Obter o nome do repositÃ³rio que disparou a aÃ§Ã£o'
      run: |
        REPO_NAME=$(basename "${{ github.repository }}")
        echo "O nome do repositÃ³rio que disparou a action Ã©: $REPO_NAME"
        echo "repo_name=$REPO_NAME" >> $GITHUB_ENV
      shell: bash

    - name: 'Build Parent e Gerar JARs'
      run: |
        cd parent
        mvn clean package -DskipTests -q
        mkdir -p core/target
        mkdir -p module
        cp mv-ged-core/target/*.jar core/target/
        cp mv-gap-core/target/*.jar core/target/
        echo "Arquivos JAR movidos para core/target"
        cp -r ${{ env.repo_name }} module/
        echo "Arquivos do projeto movido para module"
        cd ..
      shell: bash

    